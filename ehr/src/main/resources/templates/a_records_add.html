<html xmlns:th="http://www.thymeleaf.org">
<link rel="stylesheet" type="text/css" th:href="@{/css/Main.css}">
<link rel="stylesheet" type="text/css" th:href="@{/css/index.css}">
<script th:src="@{/js/Choose.js}" ></script>
<script th:src="@{/js/MyJs.js}" ></script>
<script th:src="@{/js/WebCalendar.js}" ></script>
<script type="text/javascript">
    function chknull() {
        if (document.getElementById('enumber').value == '') {
            alert('工号不能为空');
            form1.enumber.focus();
            return false;
        }
        if (document.getElementById('day').value == '') {
            alert('考勤时间不能为空');
            form1.day.focus();
            return false;
        }
    }
</script>
<script type="text/javascript">
    function PageCheck() {
        var strUploadFile = document.getElementById('uploadFile').value;
        if (strUploadFile == "") {
            alert("请选择要上传的附件！");
            return false;
        }
        var nameLen = strUploadFile.length;
        var rightName = strUploadFile.substr(nameLen - 4, 4).toLowerCase();
        var sAllowExt = ".doc|.docx|.xls|.xlsx|.ppt|.pptx|.pdf|.rar|.zip|.gif|.jpg|.jpeg";
        var str = document.getElementById('uploadFile').value;
        var rightName = str.substr(str.lastIndexOf('.') + 1, str.length - str.lastIndexOf('.')).toLowerCase();
        if (sAllowExt.indexOf(rightName) == -1) {
            alert('对不起，您只能上传【' + sAllowExt + '】格式的文件\r如果需要上传其他格式的文件，请联系系统管理员！');
            return false;
        }
    }

    function AttDown() {
        if (document.getElementById('fjlb').value == '') {
            alert('请先选中附件！');
            return false;
        }
        else {
            var num = Math.random();
            var littleproduct = document.getElementById("fjlb");
            var cindex = littleproduct.selectedIndex;
            var cText = littleproduct.options[cindex].text;
            var cValue = littleproduct.options[cindex].value;
            window.open("../../AttDown.aspx?tmp=" + num + "&number=" + cValue + "&fname=hr/h11", "_blank", "height=1, width=1,toolbar=no, menubar=no, scrollbars=no,resizable=yes,location=no, status=no")
        }
    }

    function AttDel() {
        if (document.getElementById('fjlb').value == '') {
            alert('请先选中附件！');
            return false;
        }
        else {
            if (!confirm("您确定要删除此附件吗？"))
                return false;
            var num = Math.random();
            var littleproduct = document.getElementById("fjlb");
            var cindex = littleproduct.selectedIndex;
            var cText = littleproduct.options[cindex].text;
            var cValue = littleproduct.options[cindex].value;
            window.open("../../AttDel.aspx?tmp=" + num + "&number=" + cValue + " ", "window", "height=1, width=1,top=150,left=150,toolbar=no, menubar=no, scrollbars=no,resizable=yes,location=no, status=no");
        }
    }
</script>
<head id="Head1"><meta http-equiv="Content-Type" content="text/html; charset=gb2312" /><title>
	考勤记录
</title>
</head>
<body class="main">
    <form method="post" action="/attendence/add" id="form1" enctype="multipart/form-data">
<div class="aspNetHidden">
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUJMTY4ODc5MTA2DxYCHhNWYWxpZGF0ZVJlcXVlc3RNb2RlAgEWAgIBDxYCHgdlbmN0eXBlBRNtdWx0aXBhcnQvZm9ybS1kYXRhFhpmDw9kFgIeCHJlYWRvbmx5BQhyZWFkb25seWQCAQ8PZBYCHwIFCHJlYWRvbmx5ZAICDw9kFgIfAgUIcmVhZG9ubHlkAgMPD2QWAh8CBQhyZWFkb25seWQCBA8PZBYCHwIFCHJlYWRvbmx5ZAIFDw9kFgIfAgUIcmVhZG9ubHlkAgYPD2QWAh8CBQhyZWFkb25seWQCBw8PZBYCHwIFCHJlYWRvbmx5ZAIKDxBkEBUAFQAUKwMAZGQCCw8PZBYCHgdvbmNsaWNrBRtqYXZhc2NyaXB0OnJldHVybiBBdHREZWwoKTtkAg0PD2QWAh8DBR5qYXZhc2NyaXB0OnJldHVybiBQYWdlQ2hlY2soKTtkAg4PD2QWAh8DBRxqYXZhc2NyaXB0OnJldHVybiBjaGtudWxsKCk7ZAIRDw8WAh4EVGV4dAUSMjAxOTQxMjIxODM0MTA1ODkyZGRk" />
</div>

        <table width="100%" border="0" cellpadding="0" cellspacing="0">
            <tr>
                <td class="td_base" width="80%" height="25px">考勤记录
                </td>
                <td class="td_base" width="20%"></td>
            </tr>
            <tr>
                <td colspan="2">
                    <table class="form" border="0" cellpadding="0" cellspacing="0" width="100%">
                        <tr>
                            <td align="center" colspan="4">
                                <b>员工信息</b>
                            </td>
                        </tr>
                        <tr>
                            <td class="form-item" style="width: 20%"><font color="red">*</font>员工工号：
                            </td>
                            <td style="width: 30%">
                                <input name="enumber" type="text" id="enumber" class="mytext" readonly="readonly" style="width:80%;" /><a href="javascript:void(0)"><img
                                    onclick="openunit();" alt="" src="/pic/choose_002.gif" border="0"></a>
                            </td>
                            <td class="form-item" style="width: 20%">员工姓名：
                            </td>
                            <td style="width: 30%">
                                <input name="ename" type="text" id="ename" class="mytext" readonly="readonly" style="width:90%;" />
                            </td>
                        </tr>
                        <tr>
                            <td class="form-item">性别：
                            </td>
                            <td>
                                <input name="egender" type="text" id="egender" class="mytext" readonly="readonly" style="width:90%;" />
                            </td>
                            <td class="form-item">员工身份证：
                            </td>
                            <td>
                                <input name="identitynumber" type="text" id="identitynumber" class="mytext" readonly="readonly" style="width:90%;" />
                            </td>
                        </tr>
                        <tr>
                            <td class="form-item">所在部门名称：
                            </td>
                            <td colspan="3">
                                <input name="edepartmentnum" type="text" id="edepartmentnum" class="mytext" readonly="readonly" style="width:96%;" />
                            </td>
                        </tr>
                        <tr>
                            <td class="form-item">岗位：
                            </td>
                            <td>
                                <input name="epost" type="text" id="epost" class="mytext" readonly="readonly" style="width:90%;" />
                            </td>
                            <td class="form-item">职务：
                            </td>
                            <td>
                                <input name="eposttype" type="text" id="eposttype" class="mytext" readonly="readonly" style="width:90%;" />
                            </td>
                        </tr>
                        <tr>
                            <td colspan="4" style="text-align: center">
                                <strong>考勤信息</strong>
                            </td>
                        </tr>
                        <tr>
                            <td class="form-item"><font color="red">*</font>考勤时间：
                            </td>
                            <td>
                                <input name="day" type="text" id="day" class="mytext" onclick="SelectDate(this,&#39;yyyy-MM-dd&#39;)" readonly="readonly" style="width:90%;" />
                            </td>
                            <td class="form-item">考勤类型：
                            </td>
                            <td>
                                <select name="KqLeiXing" id="KqLeiXing" style="width:90%;">
									<option value="正常">正常</option>
									<option value="迟到">迟到</option>
									<option value="早退">早退</option>
									<option value="旷工">旷工</option>
								
								</select>
                            </td>
                        </tr>
                        <tr>
                            <td class="form-item">考勤备注：
                            </td>
                            <td colspan="3">
                                <textarea name="Beizhu" rows="2" cols="20" id="Beizhu" class="mytextarea" style="height:78px;width:96%;">
</textarea>
                            </td>
                        </tr>
                        <tr>
                            <td class="form-item">上传附件：
                            </td>
                            <td colspan="3">
                                <input name="uploadFile" type="file" id="uploadFile" style="width: 80%" />
                                <input type="submit" name="Button4" value="上传" onclick="javascript:return PageCheck();" id="Button4" class="mybtn" />
                            </td>
                        </tr>
                        <tr>
                            <td colspan="4" align="center">
                                <input type="submit" name="Button1" value="确定" onclick="javascript:return chknull();" id="Button1" class="mybtn" />
                                <input id="Button2" class="mybtn" onclick="window.close()" type="button" value="关闭" />
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
        <script type="text/javascript">
            var wName;
            function openunit() {
                var num = Math.random();
                var str = "" + document.getElementById('enumber').value + "|" + document.getElementById('ename').value + "|" + document.getElementById('egender').value + "|" + document.getElementById('identitynumber').value + "|"  + document.getElementById('edepartmentnum').value + "|" + document.getElementById('epost').value + "|" + document.getElementById('eposttype').value + "";

                //browser
                var bstr = getBrowserType();
                if (bstr == '3' | bstr == '4' | bstr == '5') {
                    window.open("../page/select_employee", 'window', 'height=600,width=650,top=150,left=300,toolbar=no,menubar=no,scrollbars=yes, resizable=yes,location=no, status=no');
                }
                else {
                    wName = window.showModalDialog("../page/select_employee", "window", "dialogWidth:650px;DialogHeight=600px;status:no;scroll=yes;help:no");
                }

                var arr = wName.split("|");
                for (var i = 0; i < arr.length; i++) {
                    document.getElementById("enumber").value = arr[1];
                    document.getElementById("ename").value = arr[2];
                    document.getElementById("egender").value = arr[3];
                    document.getElementById("identitynumber").value = arr[4];
                    document.getElementById("edepartmentnum").value = arr[5];
                    document.getElementById("epost").value = arr[6];
                    document.getElementById("eposttype").value = arr[7];
                }
            }

            function setValue(str) {
                var arr = str.split("|");
                for (var i = 0; i < arr.length; i++) {
                    document.getElementById("enumber").value = arr[1];
                    document.getElementById("ename").value = arr[2];
                    document.getElementById("egender").value = arr[3];
                    document.getElementById("identitynumber").value = arr[4];
                    document.getElementById("edepartmentnum").value = arr[5];
                    document.getElementById("epost").value = arr[6];
                    document.getElementById("eposttype").value = arr[7];
                }
            }
        </script>
    </form>
</body>
</html>
